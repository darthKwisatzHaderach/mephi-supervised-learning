import numpy as np
from sklearn.linear_model import LinearRegression
import matplotlib.pyplot as plt

# Метод reshape((-1, 1)) используется для того, чтобы преобразовать данные в формат,
# который нужен для работы с моделями машинного обучения.
# Представьте, что у вас есть список чисел, например, веса нескольких предметов.
# В программировании эти данные хранятся в виде вектора — последовательности значений.
# Когда мы работаем с моделями машинного обучения, нам часто нужно,
# чтобы данные были представлены в виде таблицы, где каждая строка — это отдельный объект (например, предмет),
# а каждый столбец — это признак (например, вес).
# Даже если у нас есть только один признак (например, только вес),
# модель всё равно ожидает данные в виде таблицы с несколькими столбцами.
# Поэтому мы используем метод reshape((-1, 1)),
# чтобы преобразовать наш одномерный вектор (список весов) в двумерный массив,
# где каждый вес будет находиться в отдельной строке и единственном столбце.
# Это позволяет правильно подготовить данные для обучения модели.
x = np.array([5, 15, 25, 35, 45, 55]).reshape((-1, 1))
y = np.array([5, 20, 14, 32, 22, 38])

model = LinearRegression()
model.fit(x, y)

w0 = model.intercept_
w1 = model.coef_[0]
print(f"Обученная модель: y = {w0:.2f} + {w1:.2f} × x")

y_pred = model.predict(x)

plt.scatter(x, y, label='Данные')
plt.plot(x, y_pred, color='red', linewidth=2, label='Регрессия')
plt.xlabel('X')
plt.ylabel('y')
plt.legend()
plt.show()
